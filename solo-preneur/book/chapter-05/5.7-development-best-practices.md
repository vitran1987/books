5.7 Thực Hành Phát Triển Tốt Nhất: Quy Chuẩn và Kỷ Luật Lập Trình
Khi “nợ kỹ thuật” gõ cửa: Cái giá của sự cẩu thả
Ánh mắt của thầy Tuấn dừng lại thật lâu trên màn hình máy tính, nơi chứa ba mươi tập tin mã nguồn mà Minh Anh đã miệt mài viết suốt hai tháng. Không khí trong phòng như chùng xuống khi thầy nhẹ nhàng nhận xét: “Mã của em chạy được, tính năng cũng ổn, nhưng em đang tích lũy nợ kỹ thuật rất nhanh. Nếu không chỉnh sửa sớm, chỉ sáu tháng nữa thôi, mỗi lần thêm chức năng mới hay sửa lỗi, em sẽ mất gấp ba lần thời gian hiện tại vì mọi thứ quá rối rắm.” Minh Anh thoáng bối rối, bởi cô vẫn nghĩ mọi thứ ổn: kiểm thử đều qua, ứng dụng chạy mượt, người dùng hài lòng. Nhưng dưới con mắt của người từng trải, thầy chỉ ra hàng loạt vấn đề: hàm dài lê thê hai trăm dòng, tên biến mơ hồ kiểu “dữ_liệu”, “tạm”, “x”, chú thích thì lẫn lộn giữa hai thứ tiếng, nhiều tập tin chẳng có dòng giải thích nào, đoạn mã giống nhau lặp lại ở năm nơi, và không hề có xử lý lỗi cho những trường hợp đặc biệt.

Thầy ví von nợ kỹ thuật như khoản vay ngân hàng: mỗi lần viết vội vàng, bỏ qua chuẩn mực chỉ để kịp ra mắt tính năng, là mỗi lần “vay mượn” thời gian của tương lai. Mỗi lần bỏ qua việc chỉnh sửa một hàm phức tạp, không viết tài liệu, không tách đoạn mã lặp lại thành phần dùng chung, là mỗi lần tự cộng thêm một khoản nợ nhỏ. Ban đầu, những món nợ ấy tưởng như vô hại, nhưng chúng tích tụ dần, sinh ra “lãi suất” – mỗi lần cần sửa đổi, thời gian lại kéo dài vì mã khó đọc, khó hiểu, khó kiểm thử. Đến một lúc nào đó, “lãi suất” ấy lớn đến mức không thể thêm chức năng mới, vì chỉ cần thay đổi nhỏ cũng có thể làm hỏng những phần khác mà không ai ngờ tới. Khi ấy, chỉ còn cách “trả nợ” bằng việc viết lại toàn bộ – một công việc có thể kéo dài hàng tháng trời. Thầy khuyên Minh Anh nên đặt ra quy chuẩn chất lượng mã ngay từ bây giờ và áp dụng tự động, để tránh tích lũy thêm nợ kỹ thuật.

Công cụ kiểm tra và định dạng mã: Cảnh sát thầm lặng
Việc đầu tiên Minh Anh làm là thiết lập các công cụ kiểm tra và định dạng mã để đảm bảo mọi dòng lệnh đều tuân thủ một chuẩn chung. Cô cài đặt một phần mềm kiểm tra mã nguồn, giúp phát hiện những thói quen xấu như biến khai báo mà không dùng, thiếu xử lý lỗi, hay những lỗi tiềm ẩn khó lường. Thay vì tự mình cấu hình từng quy tắc, Minh Anh chọn một bộ quy chuẩn được cộng đồng lập trình viên lớn đúc kết từ kinh nghiệm thực chiến. Bộ quy chuẩn này yêu cầu hàm không được dài quá năm mươi dòng, tên biến phải rõ nghĩa, phải có dấu cách sau dấu phẩy, dùng “hằng” thay vì “biến” nếu không thay đổi giá trị, và luôn phải xử lý trường hợp lỗi khi làm việc với dữ liệu bất định.

Nhưng chỉ cài đặt công cụ thôi chưa đủ – Minh Anh còn phải đảm bảo mọi quy tắc được kiểm tra tự động mỗi khi có thay đổi. Cô tích hợp công cụ này vào trình soạn thảo mã, để mỗi khi gõ sai quy chuẩn, dòng lệnh sẽ được gạch chân đỏ cùng thông báo cụ thể. Tiếp đó, cô thiết lập một bước kiểm tra tự động trước khi lưu trữ mã lên kho chung: nếu phát hiện lỗi, việc lưu trữ sẽ bị chặn cho đến khi sửa xong. Cuối cùng, cô tích hợp kiểm tra này vào quy trình kiểm duyệt tự động trên hệ thống, đảm bảo dù có lách qua bước kiểm tra trước đó, mọi thay đổi vẫn phải vượt qua vòng kiểm tra cuối cùng trước khi được chấp nhận.

Song song với đó, Minh Anh sử dụng một công cụ định dạng mã tự động, giúp mọi dòng lệnh đều được căn chỉnh, xuống dòng, đặt dấu nháy, dấu phẩy… theo một chuẩn duy nhất. Điều đặc biệt là công cụ này không cho phép tùy chỉnh linh tinh – mọi dự án đều có một phong cách thống nhất, tránh tranh cãi vô bổ về việc nên dùng dấu nháy đơn hay kép. Mỗi khi lưu tập tin, mã nguồn tự động được làm đẹp, những đoạn lộn xộn, thụt lề sai, dòng quá dài, khoảng trắng thừa… đều được chỉnh lại ngay lập tức.

Nhờ áp dụng nghiêm ngặt các quy tắc kiểm tra và định dạng, chất lượng mã của Minh Anh cải thiện rõ rệt chỉ sau một tuần. Công cụ kiểm tra phát hiện bốn mươi hai lỗi tiềm ẩn mà trước đó cô không hề nhận ra: năm biến khai báo nhưng không dùng, mười hai trường hợp thiếu xử lý lỗi khi làm việc với dữ liệu bất định, tám hàm quá phức tạp với nhiều tầng điều kiện lồng nhau, mười bảy chỗ so sánh giá trị không chính xác có thể gây lỗi khó lường. Sau khi sửa hết các cảnh báo, Minh Anh chạy lại bộ kiểm thử và phát hiện thêm ba lỗi thực sự mà trước đây chưa từng phát hiện – tất cả đều liên quan đến việc thiếu xử lý lỗi.

Quy trình làm việc với Git: Nhánh, kiểm duyệt và sự cẩn trọng
Ngày trước, Minh Anh quen làm việc trên một nhánh duy nhất, cứ thích là lưu lại, chẳng cần phân biệt đâu là chức năng mới, đâu là sửa lỗi. Hậu quả là mỗi lần xem lại lịch sử thay đổi, mọi thứ rối như tơ vò: một bản lưu chứa ba chức năng khác nhau, lời nhắn thì chung chung kiểu “sửa lỗi”, “cập nhật”, có khi còn đẩy cả đoạn mã hỏng lên kho chính khiến hệ thống chạy thử bị sập. Thầy Tuấn nhìn thấy cảnh đó liền bảo: “Muốn làm việc lớn, phải có kỷ luật. Hãy chia nhánh rõ ràng, mỗi thay đổi một nhánh, mỗi chức năng một dòng chảy riêng.”

Từ đó, Minh Anh áp dụng mô hình chia nhánh phổ biến: nhánh chính chỉ chứa mã đã kiểm duyệt, không ai được phép đẩy trực tiếp lên, mọi thay đổi đều phải qua bước kiểm tra. Nhánh phát triển là nơi tập hợp các chức năng mới, mỗi chức năng lại nằm trên một nhánh nhỏ riêng biệt, đặt tên rõ ràng như “chuc-nang-tro-chuyen-nhom”, “tich-hop-thanh-toan”. Khi hoàn thành, cô gửi yêu cầu hợp nhất vào nhánh phát triển, kiểm tra kỹ càng rồi mới tạo nhánh phát hành, chạy thử lần cuối trước khi đưa lên nhánh chính để triển khai thực tế.

Điều quan trọng nhất mà thầy dặn là: “Đừng bao giờ lưu lại mã mà chưa tự mình xem lại một lần.” Mỗi khi hoàn thành một chức năng, Minh Anh mở giao diện kiểm tra thay đổi, đọc từng dòng như thể đang soi lỗi cho người khác. Nhờ vậy, cô phát hiện ra nhiều lỗi nhỏ: quên xóa dòng ghi chú thử nghiệm, để sót đoạn mã bị ẩn, viết nhầm chính tả trong lời giải thích, hay giữ lại những phần khai báo không còn dùng đến. Việc tự kiểm tra với đôi mắt mới, nhất là sau khi nghỉ ngơi một lúc, giúp cô nhận ra những điểm chưa ổn mà lúc viết không để ý.

Tuy nhiên, tự mình kiểm tra cũng có giới hạn – nhiều khi quá quen với cách làm cũ, Minh Anh không nhận ra còn cách nào tốt hơn. Lúc này, cô nhờ đến sự trợ giúp của trí tuệ nhân tạo. Cô gửi toàn bộ thay đổi cho một công cụ kiểm duyệt tự động, nhờ nó soi từng dòng, chỉ ra những điểm yếu như: chưa kiểm tra độ dài tin nhắn, truy vấn dữ liệu lặp lại gây chậm, kết nối không có giới hạn thời gian dễ gây tràn bộ nhớ, lỗi xảy ra mà không báo cho người dùng, hay đặt tên hàm quá chung chung khiến người đọc khó hiểu. Nhờ vậy, chất lượng mã của Minh Anh ngày càng tiến bộ, ít lỗi hơn và dễ bảo trì hơn.

Tài liệu hóa: Khi mã biết tự kể chuyện
Có lần, Minh Anh quay lại xem đoạn mã mình viết cách đây ba tuần để tối ưu hóa lời nhắc cho trí tuệ nhân tạo. Cô nhìn vào một hàm dài bảy mươi dòng, tên thì chung chung, bên trong lồng ba vòng lặp, năm điều kiện, hai mươi biến với những cái tên như “tạm”, “kết_quả”, “dữ_liệu_2”, “x”. Cô phải mất gần một giờ đọc lại từng dòng mới hiểu được ý đồ của chính mình. Lúc ấy, cô mới thấm thía tầm quan trọng của việc để mã tự giải thích, và khi cần thì chú thích phải rõ ràng, dễ hiểu.

Thầy Tuấn dạy cô hai nguyên tắc: Thứ nhất, mã tốt là mã mà chỉ cần đọc tên hàm, tên biến đã hiểu được ý nghĩa, không cần chú thích dài dòng. Thay vì viết lời giải thích cho một đoạn mã phức tạp, hãy tách nó thành một hàm nhỏ với tên rõ ràng, ví dụ như “lay_danh_sach_hoc_sinh_xuat_sac”, ai đọc cũng hiểu mà không cần xem chi tiết bên trong. Thứ hai, khi cần chú thích, hãy giải thích lý do tại sao làm như vậy, chứ không phải chỉ lặp lại điều mã đã thể hiện. Nếu lọc học sinh có điểm trung bình trên tám, đừng chú thích “lọc học sinh điểm trên tám”, mà hãy ghi rõ: “Chỉ hiển thị học sinh xuất sắc để tạo động lực thi đua, dựa trên phản hồi từ đợt thử nghiệm.”

Sau khi áp dụng hai nguyên tắc ấy, Minh Anh chỉnh lại hàm tối ưu lời nhắc: thay vì một khối dài lê thê, cô chia thành các hàm nhỏ như “trich_xuat_tu_khoa”, “sap_xep_theo_muc_do_lien_quan”, “gioi_han_so_luong_tu”, “dinh_dang_cho_tri_tue_nhan_tao”. Tên biến cũng được đặt lại cho rõ ràng: “tạm” thành “tu_khoa_da_loc”, “dữ_liệu_2” thành “doan_loi_nhac_xep_hang”, “x” thành “so_luong_tu”. Nhờ vậy, người ngoài nhìn vào cũng hiểu được luồng xử lý tổng thể mà không cần đọc từng chi tiết nhỏ.

Không dừng lại ở đó, Minh Anh còn viết tài liệu hướng dẫn cho từng hàm, từng chức năng, giải thích rõ ý nghĩa, cách sử dụng, ví dụ minh họa. Nhờ vậy, mỗi khi cần tra cứu lại hoặc hướng dẫn người mới, chỉ cần đưa tài liệu là ai cũng có thể hiểu và sử dụng đúng cách, không còn cảnh “mã của ai, chỉ người ấy hiểu”.

Bảo vệ dữ liệu: Khi an toàn không còn là chuyện xa xỉ
Ban đầu, Minh Anh chẳng mấy bận tâm đến chuyện bảo mật. Cô nghĩ ứng dụng giáo dục cho học sinh thì có gì mà phải lo, đâu phải ngân hàng hay sàn giao dịch tiền số. Nhưng một buổi trò chuyện, thầy Tuấn chỉ thẳng vào thực tế: “Em đang lưu trữ tên tuổi, thư điện tử, số điện thoại, ảnh bài tập của học sinh, thông tin thanh toán của phụ huynh, cả những nội dung trí tuệ do hệ thống sinh ra. Nếu bị xâm nhập, không chỉ mất dữ liệu mà còn mất luôn niềm tin của người dùng, thậm chí vi phạm luật bảo vệ thông tin cá nhân.” Nghe vậy, Minh Anh mới giật mình, bắt đầu tìm hiểu sâu về mười lỗ hổng phổ biến nhất trong các ứng dụng trực tuyến và cách phòng tránh.

Lỗ hổng đầu tiên là tấn công chèn lệnh, đặc biệt là chèn lệnh truy vấn dữ liệu. May mắn thay, Minh Anh sử dụng công cụ quản lý dữ liệu tự động kiểm soát đầu vào, nhưng cô vẫn cẩn thận rà soát lại toàn bộ mã nguồn, đảm bảo không có chỗ nào tự ý ghép chuỗi truy vấn từ dữ liệu người dùng. Lỗ hổng thứ hai là xác thực không chặt chẽ – cô đảm bảo mật khẩu luôn được mã hóa, mã xác thực có thời hạn và được kiểm tra kỹ càng, đồng thời thiết lập giới hạn số lần đăng nhập sai để ngăn chặn tấn công dò tìm. Nếu một địa chỉ mạng đăng nhập sai năm lần trong mười phút, hệ thống sẽ tự động khóa trong ba mươi phút.

Lỗ hổng thứ ba là lộ thông tin nhạy cảm. Minh Anh rà soát lại tất cả các điểm truy xuất dữ liệu, chỉ trả về những trường thực sự cần thiết cho người dùng cuối, không bao giờ để lộ mật khẩu hay thư điện tử trừ khi chính chủ yêu cầu và đã xác thực. Nhờ vậy, dữ liệu cá nhân được bảo vệ chặt chẽ hơn.

Có lần kiểm tra, Minh Anh phát hiện ảnh bài tập của học sinh được lưu ở nơi ai có đường dẫn cũng xem được. Điều này cực kỳ nguy hiểm, bởi chỉ cần lộ một đường dẫn là thông tin cá nhân, thậm chí hình ảnh chân dung, có thể bị phát tán. Cô lập tức chuyển sang chế độ riêng tư, chỉ cấp quyền truy cập tạm thời trong mười lăm phút cho người thực sự cần xem, sau đó đường dẫn tự động hết hiệu lực.

Chưa dừng lại ở đó, Minh Anh còn thiết lập các quy tắc bảo vệ trình duyệt, chỉ cho phép tải mã lệnh từ nguồn tin cậy, không cho thực thi mã lạ, không nhận dữ liệu từ trang ngoài. Toàn bộ kết nối đều được mã hóa, chỉ chấp nhận truy cập từ đúng địa chỉ của hệ thống, chặn mọi yêu cầu lạ từ bên ngoài. Nhờ vậy, ứng dụng của cô vững vàng trước những đợt tấn công phổ biến nhất trên mạng.

Quản lý chi phí và tối ưu nguồn lực: Đếm từng giờ, tính từng phút
Không chỉ lo chuyện máy chủ, Minh Anh còn chú ý đến từng giờ công bỏ ra để xây dựng, sửa lỗi, bảo trì hệ thống. Cô ghi lại thời gian trung bình để hoàn thành một chức năng mới, thời gian sửa một lỗi, tỷ lệ thời gian dành cho phát triển so với bảo trì, và cả tỷ lệ mã phải viết lại trong vòng ba tháng – chỉ số cho thấy mức độ “nợ kỹ thuật” đang tăng hay giảm.

Để tiết kiệm thời gian và công sức, Minh Anh đặt ra quy tắc: trước khi bắt tay vào bất kỳ chức năng nào, cô dành nửa giờ để lên kế hoạch, dự đoán khó khăn, ước lượng công việc. Nhiều lần trước đây, cô nghĩ chỉ mất một ngày, nhưng rồi hai ngày trôi qua vẫn chưa xong vì phát sinh nhiều tình huống ngoài dự kiến. Giờ đây, cô tận dụng trí tuệ nhân tạo để phân tích, liệt kê mọi thách thức kỹ thuật, từ đó quyết định nên làm ngay hay để sau.

Tiếp theo, cô ưu tiên những việc mang lại giá trị lớn mà tốn ít công sức. Mỗi yêu cầu được chấm điểm về mức độ quan trọng với người dùng và độ khó khi thực hiện. Việc nào dễ mà quan trọng thì làm trước, việc nào khó mà ít giá trị thì gác lại. Nhờ vậy, mỗi giờ làm việc đều mang lại hiệu quả tối đa.

Cuối cùng, Minh Anh tận dụng tối đa những gì đã làm. Mỗi khi xây dựng một chức năng, cô suy nghĩ liệu có thể biến nó thành phần dùng chung cho nhiều nơi khác không. Ví dụ, khi làm chức năng tải ảnh bài tập, cô tạo luôn một bộ phận tải ảnh có thể dùng cho ảnh đại diện, ảnh khóa học, bất cứ đâu cần tải ảnh. Nhờ vậy, mỗi lần cần thêm chức năng tương tự, chỉ mất vài phút thay vì hàng giờ viết lại từ đầu. Kho mã nguồn của cô giờ đây có hẳn một thư mục chứa ba mươi thành phần dùng chung, mỗi thành phần tiết kiệm được không biết bao nhiêu thời gian cho những lần phát triển sau này.

Thành quả: Khi chất lượng mã trở thành động lực tăng tốc
Chỉ sau ba tháng kiên trì áp dụng kỷ luật và quy chuẩn phát triển, Minh Anh ngồi lại, mở bảng thống kê và không khỏi ngạc nhiên trước những con số biết nói. Tỷ lệ “nợ kỹ thuật” giảm mạnh từ hai mươi lăm phần trăm xuống chỉ còn tám phần trăm, mã trùng lặp giảm từ mười hai phần trăm xuống ba phần trăm, tỷ lệ kiểm thử bao phủ tăng vọt từ sáu mươi lên tám mươi lăm phần trăm. Nhưng điều khiến cô vui nhất không phải là những con số khô khan, mà là sự thay đổi rõ rệt trong tốc độ và chất lượng sản phẩm.

Thời gian trung bình để hoàn thành một chức năng mới giảm từ bốn ngày xuống còn hai ngày – không phải vì Minh Anh gõ phím nhanh hơn, mà vì mã nguồn sạch sẽ, dễ sửa đổi, nhiều thành phần có thể dùng lại. Thời gian sửa một lỗi giảm từ hai tiếng xuống chỉ còn ba mươi phút, bởi các công cụ kiểm tra và bộ kiểm thử đã ngăn chặn phần lớn lỗi lọt vào hệ thống, những lỗi còn lại cũng dễ tìm, dễ sửa nhờ cấu trúc mã rõ ràng. Tỷ lệ thời gian dành cho bảo trì giảm từ bốn mươi phần trăm xuống hai mươi phần trăm, nhường chỗ cho việc phát triển những ý tưởng mới.

Số sự cố trên hệ thống giảm từ năm lần mỗi tháng xuống chỉ còn chưa đến một lần. Các đợt kiểm tra bảo mật hàng tháng không phát hiện thêm lỗ hổng nào mới suốt ba tháng liên tiếp. Số lỗi do người dùng báo về giảm từ mười lỗi mỗi tuần xuống chỉ còn hai, mà cả hai đều là lỗi nhỏ về giao diện, không ảnh hưởng đến hoạt động chính. Thời gian kiểm duyệt mã mỗi lần hợp nhất giảm từ hai tiếng xuống chỉ còn hai mươi phút, bởi hầu hết vấn đề đã được phát hiện và xử lý từ trước.

Nhưng thay đổi lớn nhất lại nằm ở tâm lý. Trước đây, mỗi lần cần thêm chức năng mới hay sửa đổi mã cũ, Minh Anh luôn thấp thỏm lo sợ sẽ làm hỏng thứ gì đó ở nơi khác, phải kiểm tra thủ công rất lâu mà vẫn không yên tâm. Giờ đây, với bộ kiểm thử toàn diện, công cụ kiểm tra tự động, quy trình kiểm duyệt chặt chẽ và mã nguồn sáng sủa, cô tự tin chỉnh sửa bất kỳ phần nào của hệ thống. Mỗi lần thử nghiệm ý tưởng mới, cô không còn ngại ngần, bởi biết rằng mọi sai sót đều sẽ được phát hiện kịp thời.

Minh Anh nhận ra, đầu tư cho chất lượng mã và quy trình phát triển không phải là gánh nặng làm chậm tiến độ, mà chính là nền tảng vững chắc để duy trì tốc độ cao trong thời gian dài. Hai tháng đầu, cô chạy đua với thời gian, ra mắt tính năng liên tục nhưng “nợ kỹ thuật” chất chồng. Đến tháng thứ ba, tốc độ giảm vì phải quay lại sửa lỗi, trả nợ cũ. Nhưng từ khi xây dựng được nền tảng vững chắc, tốc độ phát triển tăng trở lại và giữ ổn định suốt nhiều tháng, không còn cảnh “chạy nước rút rồi hụt hơi”. Đó chính là sức mạnh của triết lý “làm nhanh nhưng phải chắc” – tốc độ bền vững, không phải những cú bứt phá ngắn hạn rồi chững lại.

